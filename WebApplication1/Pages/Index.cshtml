@page
@model IndexModel
<!DOCTYPE html>
<html>
<head>
    <title>Video Thumbnails</title>
    <style>
        .thumbnail-container {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        canvas {
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>Video Thumbnails</h1>
    <div id="thumbnail-container"></div>
    <input type="file" accept="video/*" id="videoInput" multiple>

    <script>
        document.getElementById('videoInput').addEventListener('change', function (event) {
            var files = event.target.files;
            var thumbnailContainer = document.getElementById('thumbnail-container');

            // Clear existing thumbnails
            thumbnailContainer.innerHTML = '';

            for (var i = 0; i < files.length; i++) {
                var file = files[i];
                var thumbnailDiv = document.createElement('div');
                thumbnailDiv.classList.add('thumbnail-container');
                var canvas = document.createElement('canvas');
                var ctx = canvas.getContext('2d');
                canvas.width = 160;
                canvas.height = 90;

                thumbnailDiv.appendChild(canvas);
                thumbnailContainer.appendChild(thumbnailDiv);

                var video = document.createElement('video');
                video.src = URL.createObjectURL(file);
                video.controls = true;
                video.onloadedmetadata = function () {
                    // Set canvas size and draw video frame onto it
                    canvas.width = this.videoWidth;
                    canvas.height = this.videoHeight;
                    ctx.drawImage(this, 0, 0, canvas.width, canvas.height);
                    // Remove the video element after generating the thumbnail
                    URL.revokeObjectURL(this.src);
                    this.remove();
                };

                video.onerror = function () {
                    console.error('Error loading the video.');
                };

                video.style.display = 'none'; // Hide the video element
                document.body.appendChild(video); // Add the video element to the document body to trigger loading
            }
        });
    </script>
</body>
</html>

